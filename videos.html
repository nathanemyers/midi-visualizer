<script src="/socket.io/socket.io.js"></script>

<style>
  body {
    margin: 0;
  }
</style>

<video width="100%" loop="true" autoplay="autoplay" muted>
  <source src="/videos/video2.mp4" type="video/webm">
  Sorry, your browser doesn't support embedded videos.
</video>

<script>
  var socket = io();

  var messages = document.getElementById('messages');
  var body = document.body

  let videos = []
  fetch('http://localhost:3000/video-list')
    .then(response => response.json())
    .then((data) => {
      videos = data.videos
    });

  function getRandomInt(max) {
    return Math.floor(Math.random() * max);
  }

  let prevVideo = null
  let newVideo = null
  function setRandomVideo() {
    while (prevVideo === newVideo) {
      newVideo = videos[getRandomInt(videos.length - 1)]
    }
    prevVideo = newVideo
    document.body.bgColor = newVideo
  }

  socket.on('note', function (msg) {
    console.log('recv msg', msg)
    if (msg.keydown) {
      setRandomBackground()
    }
  });
</script>